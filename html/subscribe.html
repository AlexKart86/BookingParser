<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
</head>


<body>
<link rel="stylesheet" href="bower_components/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css" />
<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="html/typeaheadjs.css" />
<div class="container-fluid">
    <div class="row vertical-center-row">
        <form>
            <div class="form-group">
               <input class="selectpicker form-control" id="station_from" placeholder="Станция отправления"> </input>
            </div>
            <div class="form-group">
                <input class="selectpicker form-control" id="station_to" placeholder="Станция назначения"> </input>
            </div>
            <div class="form-group">

                <!--<label for="dtp">Дата</label>-->
                <div class="input-group date" id="dtp">
                    <input type="text" class="form-control" id="dtp_value" placeholder="Дата отправления"><span class="input-group-addon">
                    <span class="glyphicon glyphicon-calendar"></span></span>
                </div>
            </div>
            <div class="form-group">
                <input class="selectpicker form-control" id="train" placeholder="Номер поезда"> </input>
            </div>
            <div class="form-group">
                <input type="checkbox" id="is_report_" >Сообщать, если появились купе </input>
            </div>
            <div class="form-group">
                <button type="button" class="btn btn-primary" id="start">Отслеживать</button>
            </div>
        </form>
    </div>
</div>
<script src="bower_components/moment/min/moment-with-locales.min.js"></script>
<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
<script src="bower_components/typeahead.js/dist/typeahead.jquery.min.js"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="bower_components/push.js/push.js"></script>

<style>
    html, body, .container-fluid  {
        height: 100%;
        margin: 10px;
        max-width: 400px;
    }
    .form-inline > * {
        margin:5px;
    }
    table .table {
        cursor: pointer;
    }
    table .collapse.in {
        display:table-row;
    }
</style>

<script>
    var station_list = {};

    var load_station_list = function(query, syncResult, asyncResult){
        $.ajax({
            url: "/get_stations",
            method: "POST",
            data: JSON.stringify({"name": query}),
            contentType: 'application/json',
            dataType: "json",
            success: function (data) {
                //console.log(data);
                $.each(data, function(idx, dt){
                    //console.log(dt);
                    station_list[dt.title] = dt.station_id;
                });
                asyncResult(data);
            }
        })
    };

    var start_on_click = function() {
//        setInterval(function(){
            Push.create("Hello world!", {
                body: "How's it hangin'?",
                requireInteraction: true,
                //timeout: 30000,
                onClick: function () {
                    window.focus();
                    this.close();
                }
            });
//        }, 2000);

    };

    $(function() {
        $('#stop').hide();
        $('#dtp').datetimepicker({
            locale: 'ru',
            format: 'DD.MM.YYYY'
        });
        $('#station_from, #station_to').typeahead({
            minLength: 2,
            highlight: true
        }, {
            source: load_station_list,
            display: 'title'
        });
        $('#start').on('click', start_on_click);
    });
</script>

</body>

</html>